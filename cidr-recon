#!/bin/bash

if [ $# -eq 0 ] || [[ $1 == "-h" ]] || [[ $1 == "--help" ]]; then
    echo "Usage: $0 <CIDR>"
    echo "Example: $0 192.168.0.0/24"
    echo ""
    echo "This tool performs basic reconnaissance on a CIDR range:"
    echo "1. Extracts TLS information (SAN, CN)"
    echo "2. Resolves DNS records"
    echo "3. Probes HTTP services (status, title, tech)"
    exit 1
fi

if [[ ! $1 =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/[0-9]{1,2}$ ]]; then
    echo "Error: Invalid CIDR format. Please provide a valid CIDR range (e.g., 192.168.0.0/24)"
    exit 1
fi

echo "[*] Starting CIDR reconnaissance for $1"
echo "[1/3] Running TLS scan..."
echo $1 | tlsx -silent -san -cn -resp-only | sort -u | \
echo "[2/3] Resolving DNS records..." | \
dnsx -silent | \
echo "[3/3] Probing HTTP services..." | \
httpx -sc -probe -title -tech-detect -silent

echo "[*] Reconnaissance completed for $1"
